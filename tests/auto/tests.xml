<?xml version="1.0" encoding="ISO-8859-1"?>
<testdefinition version="1.0">
  <suite name="libqtsparql-tests">
    <set name="qsparlq-unit" description="Unit tests of libqtsparql">
      <case name="qsparqlquery" description="qsparqlquery unit tests">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparqlquery
        </step>
      </case>
      <case name="qsparqlbinding" description="qsparqlbinding unit tests">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparqlbinding
        </step>
      </case>
      <case name="qsparql" description="qsparql unit tests">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql
        </step>
      </case>
      <environments>
        <scratchbox>true</scratchbox>
        <hardware>true</hardware>
      </environments>
    </set>
    <set name="qsparql-tracker" description="Tests for tracker plugin of qsparql">
      <pre_steps>
	<step expected_result="0">
          . /tmp/session_bus_address.user;
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker.rq;
	  tracker-import /usr/share/libqtsparql-tests/testdata_tracker.ttl
        </step>
      </pre_steps>
      <case name="test-query-contacts" description="Executing a query">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker query_contacts
        </step>
      </case>
      <case name="test-insert-and-delete-contact" description="Executing an update">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker insert_and_delete_contact ||
	  ( i=$? &amp;&amp; tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker.rq &amp;&amp;
	  tracker-import /usr/share/libqtsparql-tests/testdata_tracker.ttl &amp;&amp;
	  exit $i )
        </step>
      </case>
      <case name="test-query-with-error" description="Erroneous query">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker query_with_error
        </step>
      </case>
      <case name="test-batch-update" description="Batch update">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker batch_update ||
	  ( i=$? &amp;&amp; tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker.rq &amp;&amp;
	  tracker-import /usr/share/libqtsparql-tests/testdata_tracker.ttl &amp;&amp;
	  exit $i )
        </step>
      </case>

      <post_steps>
	<step expected_result="0">
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker.rq
        </step>
      </post_steps>
      <environments>
        <scratchbox>true</scratchbox>
        <hardware>true</hardware>
      </environments>
      <get>
	<file>/home/user/.local/share/tracker/tracker-store.log</file>
      </get>
    </set>
    <set name="qsparql-tracker-direct" description="Tests for tracker direct access plugin of qsparql">
      <pre_steps>
	<step expected_result="0">
          . /tmp/session_bus_address.user;
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker_direct.rq;
	  tracker-import /usr/share/libqtsparql-tests/testdata_tracker_direct.ttl
        </step>
      </pre_steps>
      <case name="test-query-contacts" description="Executing a query">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker_direct query_contacts
        </step>
      </case>
      <case name="test-ask-contacts" description="Executing an ASK query">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker_direct ask_contacts
        </step>
      </case>
      <case name="test-insert-and-delete-contact" description="Executing an update">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker_direct insert_and_delete_contact ||
	  ( i=$? &amp;&amp; tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker_direct.rq &amp;&amp;
	  tracker-import /usr/share/libqtsparql-tests/testdata_tracker_direct.ttl &amp;&amp;
	  exit $i )
        </step>
      </case>
      <case name="test-query-with-error" description="Erroneous query">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker_direct query_with_error
        </step>
      </case>
      <case name="test-insert-new-urn" description="Inserting a created urn">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_tracker_direct insert_new_urn
        </step>
      </case>
      <post_steps>
	<step expected_result="0">
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker_direct.rq
        </step>
      </post_steps>
      <environments>
        <scratchbox>true</scratchbox>
        <hardware>true</hardware>
      </environments>
      <get>
	<file>/home/user/.local/share/tracker/tracker-store.log</file>
      </get>
    </set>
    <set name="qsparql-threding" description="Multithreading tests">
      <pre_steps>
	<step expected_result="0">
          . /tmp/session_bus_address.user;
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_threading.rq;
        </step>
      </pre_steps>
      <case name="test-tracker-queries" description="Tracker queries">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_threading concurrentTrackerQueries
        </step>
      </case>
      <case name="test-tracker-direct-queries" description="Tracker direct queries">
        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_threading concurrentTrackerDirectQueries
        </step>
      </case>
      <case name="test-tracker-direct-inserts" description="Tracker direct inserts">

        <step expected_result="0">
	  /usr/lib/libqtsparql-tests/tst_qsparql_threading concurrentTrackerDirectInserts ||
	  ( i=$? &amp;&amp; tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_tracker_threading.rq &amp;&amp; exit $i )
        </step>
      </case>
      <post_steps>
	<step expected_result="0">
	  tracker-sparql -u -f /usr/share/libqtsparql-tests/clean_data_threading.rq
        </step>
      </post_steps>
      <environments>
        <scratchbox>true</scratchbox>
        <hardware>true</hardware>
      </environments>
      <get>
	<file>/home/user/.local/share/tracker/tracker-store.log</file>
      </get>
    </set>
  </suite>
</testdefinition>
